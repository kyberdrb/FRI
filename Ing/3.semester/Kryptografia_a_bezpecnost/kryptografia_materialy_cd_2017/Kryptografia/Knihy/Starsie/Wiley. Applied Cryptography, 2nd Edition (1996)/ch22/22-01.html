<HTML>
<HEAD>
<META name=vscategory content="Security Programming Languages">

<META name=vsisbn content="0471128457">
<META name=vstitle content="Applied Cryptography, Second Edition: Protocols,  Algorthms, and Source Code in C (cloth)">
<META name=vsauthor content="Bruce Schneier">
<META name=vsimprint  content="Wiley Computer Publishing ">
<META name=vspublisher content="John Wiley & Sons, Inc.">
<META name=vspubdate content="1/1/96">

<TITLE>APPLIED CRYPTOGRAPHY, SECOND EDITION: Protocols, Algorithms, and Source Code in C:Key-Exchange Algorithms</TITLE>
<!-- BEGIN HEADER -->
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
<SCRIPT>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//-->
</SCRIPT>

</HEAD>
<body bgcolor="ffffff" link="#006666" alink="#006666" vlink="#006666">
	<table width="640" border="0" cellpadding="0" cellspacing="0">
		<tr valign="top">
		<td>

<!--  Begin Ads ITKBAN.BOOKS //-->

<CENTER><A HREF="/adclick.html/CID=00000d3e33d6f71200000000/site=itknowledge/area=itk.books/aamsz=468x60" TARGET=_top>
<IMG BORDER=0 SRC="http://adimages.earthweb.com/images/ads/gm2_banner.gif" 
ALT="Click Here!" ></A>
<BR><A HREF="/adclick.html/CID=00000d3e33d6f71200000000/site=itknowledge/area=itk.books/aamsz=468x60" TARGET=_top>
Click Here!
</A></CENTER><BR>


<!-- ITKBAN.BOOKS End Ads //--></td>
		<td>

<!--  Begin Ads ITKBAN //-->

<CENTER><A HREF="/adclick.html/CID=00000b452954e8a400000000/site=itknowledge/area=itk/aamsz=160x60/position=top" TARGET=_top>
<IMG BORDER=0 SRC="http://adimages.earthweb.com/images/ads/160x60/compaq_dtm_sponsor.gif" 
ALT="" ></A>
<BR><A HREF="/adclick.html/CID=00000b452954e8a400000000/site=itknowledge/area=itk/aamsz=160x60/position=top" TARGET=_top>

</A></CENTER><BR>


<!-- ITKBAN End Ads //--></td>
		</tr>
		<tr><td height="1" colspan="2" bgcolor="#CCCCCC"><img src="/images/white.gif" border=0 alt=""></td></tr>
	</TABLE>
<!-- END HEADER -->
<!-- BEGIN SUB HEADER -->
	
	<table bgcolor="#FFFFFF" cellpadding="0" cellspacing="0" border="0" width="100%">
 		
		
<!-- ITK LOGO Banner -->
	
	<tr>
		<td align="left" valign="top" bgcolor="#FFFFFF"><script>
function GetCookie (name)
{
   var arg = name + "=";
   var alen = arg.length;
   var clen = document.cookie.length;
   var i = 0;
   while (i < clen)
   {
      var j = i + alen;
      if (document.cookie.substring(i, j) == arg) {
         var end = document.cookie.indexOf (";", j);
         if (end == -1)
            end = document.cookie.length;
         return unescape(document.cookie.substring(j, end));
      }
      i = document.cookie.indexOf(" ", i) + 1;
      if (i == 0) break;
   }
   return null;
}
var m1='<IMG SRC="';
var m2='/images/itk-logo.gif';
var m3='" VSPACE="10" WIDTH=434 HEIGHT=58 ALT="ITKnowledge" border="0">';
var gifstr=GetCookie("UsrType");
if((gifstr!=0 )  && (gifstr!=null)) { m2=gifstr; }
document.write(m1+m2+m3);
</script>
</td>
	</tr>
<!-- END of ITK LOGO Banner -->
	
<!-- ITK TOPNAV -->
	
	<tr>
		<td align="left" valign="top" nowrap>
<a href="/"><img src="/images/home1.gif" width=38 height=37 alt="home" border="0"></a>&nbsp;<a href="/pick-account.html"><img src="/images/accountinfo.gif" width=70 height=37 alt="account info" border="0"></a>&nbsp;<a href="/PSUser/usrreg.htm?AdminAction=InitAdd&Locale=en&URI=/"><img src="/images/subscribe2.gif" width=56 height=37 alt="subscribe" border="0" hspace="6"></a>&nbsp;<a href="/PSUser/psuserauth.htm?cmd=login&URI=/"><img src="/images/login1.gif" width=33 height=37 alt="login" hspace="5" border="0"></a>&nbsp;<a href="/search/"><img src="/images/search1.gif" width=43 height=37 alt="search" border="0" hspace="10"></a>&nbsp;<a href="/faq/faq.html"><img src="/images/faqs1.gif" width=40 height=37 alt="FAQ/help" border="0" hspace="0"></a>&nbsp;<a href="/sitemap.html"><img src="/images/sitemap1.gif" width=46 height=37 alt="site map" border="0" hspace="2"></a>&nbsp;<a href="/contactus.html"><img src="/images/contact1.gif" width=61 height=37 alt="contact us" border="0" hspace="4"></a><br>
		<img src="/images/white.gif" width="1" height="5" alt="" border="0">
</td>  
		</tr>
</table>


<!-- END of ITK TOPNAV -->
		
	
	
<!-- begin of ITK left NAV -->

<!-- BEGIN LEFT NAV -->

	<table width=99% border="0" cellpadding="2" cellspacing="0">
		<tr>
		<td bgcolor="#ffffff" width=120 valign="top" rowspan=8>
			
			
		<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">
			<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
			<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
			<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
			<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">
											
			<img src="/images/search5.gif" width=115 height=27 alt="" border="0"><br>
			<img src="/images/white.gif" width="1" height="5" alt="" border="0"><br>
		<table width="116" height="135"  bgcolor="#e0e0e0" border="1" bordercolor="#006666" cellpadding="3" cellspacing="0">
		<tr>
		<td width="116">
<input type="text" name="metaqueryText" value="" size="8">&nbsp;<input type="submit" name="submitbutton" value="Go!">
			<INPUT type="hidden" NAME="section_on" VALUE="on">
			<font face="Arial,helvetica" size="1">
			<SELECT NAME="metatags" style="font-size: 10; font-family: sans-serif;" size="1">
			<option value="keyword" SELECTED>Keyword
			<option value="vstitle">Title
			<option value="vsauthor">Author
			<option value="vsisbn">ISBN
			<option value="vspublisher">Publisher
			<option value="vsimprint">Imprint
			</SELECT></font><br>

			<input type="radio" name="ResultTemplate" value="itk-brief.hts" checked style="background-color: #e0e0e0;"><font face="arial, helvetica" color="#006666" size="1">Brief</font>
			<input type="radio" name="ResultTemplate" value="itk-full.hts" style="background-color: #e0e0e0;"><font face="arial, helvetica" color="#006666" size="1">Full</font><br>
			<font face="arial, helvetica" size="1">
			<img src="/images/bullet.gif" width=5 height=5 hspace="5" alt="" border="0">&nbsp;<a href="/search/"><font color="#006666">Advanced</font></a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/search/"><font color="#006666">Search</font></a><br>
			<img src="/images/bullet.gif" width=5 height=5 hspace="5" alt="" border="0">&nbsp;<a href="/search/search-tips.html"><font color="#006666">Search Tips</font></a>
			</font>
</td>
</tr>
</table>
	</form>
<!-- BROWSE BY TOPIC -->
		
		<form action="" name="catlist">			
		<img src="/images/browse5.gif" width=115 height=34 alt="" border="0">
<table width="120" height="32" border="1" cellspacing="0" cellpadding="3" bordercolor="#006666" bgcolor="#e0e0e0">
				<tr>
				<td width="117" align="center">
			<font face="Arial,helvetica" size="1">
			<SELECT NAME="cat" onChange='top.location.href=this.options[selectedIndex].value;' style="font-size: 10; font-family: sans-serif;">
			<option value="" selected>Please Select
			<option value="">-----------
			<option value="/reference/dir.components.html">Components
			<option value="/reference/dir.contentmanagement.html">Content Mgt
			<option value="/reference/dir.certification1.html">Certification
			<option value="/reference/dir.databases.html">Databases
			<option value="/reference/dir.enterprisemanagement1.html">Enterprise Mgt
			<option value="/reference/dir.funandgames1.html">Fun/Games
			<option value="/reference/dir.groupwareandcollaboration1.html">Groupware
			<option value="/reference/dir.hardware1.html">Hardware
			<option value="/reference/dir.intranetandextranetdevelopment1.html">Intranet Dev
			<option value="/reference/dir.middleware.html">Middleware
			<option value="/reference/dir.multimediaandgraphicdesign1.html">Multimedia
			<option value="/reference/dir.networkservices1.html">Networks 
			<option value="/reference/dir.operatingsystems.html">OS
			<option value="/reference/dir.productivityapplications1.html">Prod Apps
			<option value="/reference/dir.programminglanguages.html">Programming
			<option value="/reference/dir.security1.html">Security	
			<!-- <option value="/reference/dir.ewtraining1.html">Training Guides -->
			<option value="/reference/dir.userinterfaces.html">UI
			<option value="/reference/dir.webservices.html">Web Services
			<option value="/reference/dir.webmasterskills1.html">Webmaster
			<option value="/reference/dir.y2k1.html">Y2K
			<option value="">-----------
			<option value="/reference/whatsnew.html">New Titles
			<option value="">-----------
			<option value="/reference/dir.archive1.html">Free Archive		
			</SELECT>
			</font></td>
	</tr>
	</table>
	</form>
<!-- LEFT NAV SEARCH END -->

		</td>
		
<!-- PUB PARTNERS END -->
<!-- END LEFT NAV -->

<td rowspan="8" align="right" valign="top"><img src="/images/iswbls.gif" width=1 height=400 alt="" border="0"></td>
<td><img src="/images/white.gif" width="5" height="1" alt="" border="0"></td>
<!-- end of ITK left NAV -->

<!-- begin main content -->
<td width="100%" valign="top" align="left">


<!-- END SUB HEADER -->

<!--Begin Content Column -->

<FONT FACE="Arial,Helvetica" SIZE="-1">
To access the contents, click the chapter and section titles.
</FONT>
<P>
<B>Applied Cryptography, Second Edition: Protocols,  Algorthms, and Source Code in C (cloth)</B>
<FONT SIZE="-1">
<BR>
<I>(Publisher: John Wiley & Sons, Inc.)</I>
<BR>
Author(s): Bruce Schneier
<BR>
ISBN: 0471128457
<BR>
Publication Date: 01/01/96
</FONT>
<P>
<form name="Search" method="GET" action="http://search.earthweb.com/search97/search_redir.cgi">

<INPUT TYPE="hidden" NAME="Action" VALUE="Search">
<INPUT TYPE="hidden" NAME="SearchPage" VALUE="http://search.earthweb.com/search97/samples/forms/srchdemo.htm">
<INPUT TYPE="hidden" NAME="Collection" VALUE="ITK">
<INPUT TYPE="hidden" NAME="ResultTemplate" VALUE="itk-full.hts">
<INPUT TYPE="hidden" NAME="ViewTemplate" VALUE="view.hts">

<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="queryText" size=50 VALUE="">&nbsp;<input type="submit" name="submitbutton" value="Go!">
<INPUT type=hidden NAME="section_on" VALUE="on">
<INPUT type=hidden NAME="section" VALUE="http://www.itknowledge.com/reference/standard/0471128457/">

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=0471128457//-->
<!--TITLE=APPLIED CRYPTOGRAPHY, SECOND EDITION: Protocols, Algorithms, and Source Code in C//-->
<!--AUTHOR=Bruce Schneier//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=22//-->
<!--PAGES=513-516//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="../ch21/21-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="22-02.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H2><A NAME="Heading1"></A><FONT COLOR="#000077">Chapter 22<BR>Key-Exchange Algorithms
</FONT></H2>
<H3><A NAME="Heading2"></A><FONT COLOR="#000077">22.1 Diffie-Hellman</FONT></H3>
<P>Diffie-Hellman was the first public-key algorithm ever invented, way back in 1976 [496]. It gets its security from the difficulty of calculating discrete logarithms in a finite field, as compared with the ease of calculating exponentiation in the same field. Diffie-Hellman can be used for key distribution&#151;Alice and Bob can use this algorithm to generate a secret key&#151;but it cannot be used to encrypt and decrypt messages.
</P>
<P>The math is simple. First, Alice and Bob agree on a large prime, <I>n</I> and <I>g,</I> such that <I>g</I> is primitive mod <I>n.</I> These two integers don&#146;t have to be secret; Alice and Bob can agree to them over some insecure channel. They can even be common among a group of users. It doesn&#146;t matter.</P>
<P>Then, the protocol goes as follows:</P>
<DL>
<DD><B>(1)</B>&nbsp;&nbsp;Alice chooses a random large integer <I>x</I> and sends Bob
<DL>
<DD><I>X</I> = <I>g<SUP>x</SUP></I> mod <I>n</I>
</DL>
<DD><B>(2)</B>&nbsp;&nbsp;Bob chooses a random large integer <I>y</I> and sends Alice
<DL>
<DD><I>Y</I> = <I>g</I><SUP>y</SUP> mod <I>n</I>
</DL>
<DD><B>(3)</B>&nbsp;&nbsp;Alice computes
<DL>
<DD><I>k</I> = <I>Y<SUP>x</SUP></I> mod <I>n</I>
</DL>
<DD><B>(4)</B>&nbsp;&nbsp;Bob computes
<DL>
<DD><I>k&#180;</I> = <I>X</I><SUP>y</SUP> mod <I>n</I>
</DL>
</DL>
<P>Both <I>k</I> and <I>k&#180;</I> are equal to <I>g</I><SUP>xy</SUP> mod <I>n.</I> No one listening on the channel can compute that value; they only know <I>n, g, X,</I> and <I>Y.</I> Unless they can compute the discrete logarithm and recover <I>x</I> or <I>y,</I> they do not solve the problem. So, <I>k</I> is the secret key that both Alice and Bob computed independently.</P>
<P>The choice of <I>g</I> and <I>n</I> can have a substantial impact on the security of this system. The number (<I>n</I> - 1)/2 should also be a prime [1253]. And most important, <I>n</I> should be large: The security of the system is based on the difficulty of factoring numbers the same size as <I>n.</I> You can choose any <I>g,</I> such that <I>g</I> is primitive mod <I>n;</I> there&#146;s no reason not to choose the smallest <I>g</I> you can&#151;generally a one-digit number. (And actually, <I>g</I> does not have to be primitive; it just has to generate a large subgroup of the multiplicitive group mod <I>n.</I>)</P>
<P><FONT SIZE="+1"><B><I>Diffie-Hellman with Three or More Parties</I></B></FONT></P>
<P>The Diffie-Hellman key-exchange protocol can easily be extended to work with three or more people. In this example, Alice, Bob, and Carol together generate a secret key.
</P>
<DL>
<DD><B>(1)</B>&nbsp;&nbsp;Alice chooses a random large integer <I>x</I> and sends Bob
<DL>
<DD><I>X</I> = <I>g<SUP>x</SUP></I> mod <I>n</I>
</DL>
<DD><B>(2)</B>&nbsp;&nbsp;Bob chooses a random large integer <I>y</I> and sends Carol
<DL>
<DD><I>Y</I> = <I>g</I><SUP>y</SUP> mod <I>n</I>
</DL>
<DD><B>(3)</B>&nbsp;&nbsp;Carol chooses a random large integer <I>z</I> and sends Alice
<DL>
<DD><I>Z</I> = <I>g</I><SUP>z</SUP> mod <I>n</I>
</DL>
<DD><B>(4)</B>&nbsp;&nbsp;Alice sends Bob
<DL>
<DD><I>Z&#180;</I> = <I>Z</I><SUP>x</SUP> mod <I>n</I>
</DL>
<DD><B>(5)</B>&nbsp;&nbsp;Bob sends Carol
<DL>
<DD><I>X&#180;</I> = <I>X</I><SUP>y</SUP> mod <I>n</I>
</DL>
<DD><B>(6)</B>&nbsp;&nbsp;Carol sends Alice
<DL>
<DD><I>Y&#180;</I> = <I>Y</I><SUP><I>z</I></SUP> mod <I>n</I>
</DL>
<DD><B>(7)</B>&nbsp;&nbsp;Alice computes
<DL>
<DD><I>k</I> = <I>Y</I>&#180;<SUP><I>x</I></SUP> mod <I>n</I>
</DL>
<DD><B>(8)</B>&nbsp;&nbsp;Bob computes
<DL>
<DD><I>k</I> = <I>Z</I>&#180;<SUP><I>y</I></SUP> mod <I>n</I>
</DL>
<DD><B>(9)</B>&nbsp;&nbsp;Carol computes
<DL>
<DD><I>k</I> = <I>X</I>&#180;<SUP><I>z</I></SUP> mod <I>n</I>
</DL>
</DL>
<P>The secret key, <I>k,</I> is equal to g<SUP>xyz</SUP> mod <I>n,</I> and no one else listening in on the communications can compute that value. The protocol can be easily extended to four or more people; just add more people and more rounds of computation.</P>
<P><FONT SIZE="+1"><B><I>Extended Diffie-Hellman</I></B></FONT></P>
<P>Diffie-Hellman also works in commutitive rings [1253]. Z. Shmuley and Kevin McCurley studied a variant of the algorithm where the modulus is a composite number [1442,1038]. V. S. Miller and Neal Koblitz extended this algorithm to elliptic curves [1095,867]. Taher ElGamal used the basic idea to develop an encryption and digital signature algorithm (see Section 19.6).
</P>
<P>This algorithm also works in the Galois field GF(2<SUP>k</SUP>) [1442,1038]. Some implementations take this approach [884,1631,1632], because the computation is much quicker. Similarly, cryptanalytic computation is equally fast, so it is important to carefully choose a field large enough to ensure security.</P>
<P><FONT SIZE="+1"><B><I>Hughes</I></B></FONT></P>
<P>This variant of Diffie-Hellman allows Alice to generate a key and send it to Bob [745].
</P>
<DL>
<DD><B>(1)</B>&nbsp;&nbsp;Alice chooses a random large integer <I>x</I> and generates
<DL>
<DD><I>k</I> = <I>g</I><SUP><I>x</I></SUP> mod <I>n</I>
</DL>
<DD><B>(2)</B>&nbsp;&nbsp;Bob chooses a random large integer <I>y</I> and sends Alice
<DL>
<DD><I>Y</I> = <I>g<SUP>y</I></SUP> mod <I>n</I>
</DL>
<DD><B>(3)</B>&nbsp;&nbsp;Alice sends Bob
<DL>
<DD><I>X</I> = <I>Y<SUP>x</I></SUP> mod <I>n</I>
</DL>
<DD><B>(4)</B>&nbsp;&nbsp;Bob computes
<DL>
<DD><I>z</I> = <I>y</I><SUP>-1</SUP>
<DD><I>k&#180;</I> = <I>X<SUP>z</I></SUP> mod <I>n</I>
</DL>
</DL>
<P>If everything goes correctly, <I>k</I> = <I>k&#180;</I>.</P>
<P>The advantage of this protocol over Diffie-Hellman is that <I>k</I> can be computed before any interaction, and Alice can encrypt a message using <I>k</I> prior to contacting Bob. She can send it to a variety of people and interact with them to exchange the key individually later.</P>
<P><FONT SIZE="+1"><B><I>Key Exchange without Exchanging Keys</I></B></FONT></P>
<P>If you have a community of users, each could publish a public key, <I>X</I> = <I>g<SUP>x</I></SUP> mod <I>n,</I> in a common database. If Alice wants to communicate with Bob, she just has to retrieve Bob&#146;s public key and generate their shared secret key. She could then encrypt a message with that key and send it to Bob. Bob would retrieve Alice&#146;s public key to generate the shared secret key.</P>
<P>Each pair of users would have a unique secret key, and no prior communication between users is required. The public keys have to be certified to prevent spoofing attacks and should be changed regularly, but otherwise this is a pretty clever idea.</P>
<P><FONT SIZE="+1"><B><I>Patents</I></B></FONT></P>
<P>The Diffie-Hellman key-exchange algorithm is patented in the United States [718] and Canada [719]. A group called Public Key Partners (PKP) licenses the patent, along with other public-key cryptography patents (see Section 25.5). The U.S. patent will expire on April 29, 1997.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="../ch21/21-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="22-02.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>

[an error occurred while processing this directive]
<!-- all of the reference materials (books) have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

<!-- BEGIN SUB FOOTER -->
		<br><br>
		</TD>
    </TR>
	</TABLE>

		
	<table width="640" border=0 cellpadding=0 cellspacing=0>
		<tr>
		<td align="left" width=135><img src="/images/white.gif" width=100 height="1" alt="" border="0"></td>
		
		
<!-- END SUB FOOTER -->

<!-- all of the books have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

<!-- FOOTER -->
			
		<td width="515" align="left" bgcolor="#FFFFFF">
<font face="arial, helvetica" size="1"><b><a href="/products.html"><font color="#006666">Products</font></a>&nbsp;|&nbsp; <a href="/contactus.html"><font color="#006666">Contact Us</font></a>&nbsp;|&nbsp; <a href="/aboutus.html"><font color="#006666">About Us</font></a>&nbsp;|&nbsp; <a href="http://www.earthweb.com/corporate/privacy.html" target="_blank"><font color="#006666">Privacy</font></a> &nbsp;|&nbsp; <a href="http://www.itmarketer.com/" target="_blank"><font color="#006666">Ad Info</font></a> &nbsp;|&nbsp; <a href="/"><font color="#006666">Home</font></a></b>
		<br><br>
		
		Use of this site is subject to certain <a href="/agreement.html">Terms &amp; Conditions</a>, <a href="/copyright.html">Copyright &copy; 1996-1999 EarthWeb Inc.</a><br> 
All rights reserved.  Reproduction whole or in part in any form or medium without express written permision of EarthWeb is prohibited.</font><p>
</td>
		</tr>
</table>
</BODY>
</HTML>

<!-- END FOOTER -->

